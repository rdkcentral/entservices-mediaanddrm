Component            , File Path                                             , Line Number, Severity, Issue Type                 , Issue Description                                                                                                                                        , Code Snippet                                                                                                                   , Suggested Fix                                                                                                                               , Source
Cryptography         , Cryptography/CryptographyExtAccess.cpp                ,          54, High    , Null Dereference           , "Potential null pointer dereference: _service->Root<>() can return nullptr, but _implementation is used immediately at line 59 without null check"       , "_implementation = _service->Root<Exchange::IConfiguration>(_connectionId, Core::infinite, _T(""CryptographyImplementation""));
                                                                                                                                                                                                                                                                                              if (_implementation == nullptr) {
                                                                                                                                                                                                                                                                                              message = _T(""CryptographyExtAccess could not be instantiated."");
                                                                                                                                                                                                                                                                                              } else {
                                                                                                                                                                                                                                                                                              printf(""CryptographyExtAccess - Connection Id - %u\n"",_connectionId);
                                                                                                                                                                                                                                                                                              _implementation->Configure(_service);"                                                                                         , "The null check exists but configuration call is inside else block - this is correct. However, ensure error message is propagated properly.", Manual Analysis
Cryptography         , Cryptography/CryptographyExtAccess.cpp                ,          73, Medium  , Resource Leak              , RemoteConnection pointer obtained at line 73 may leak if Terminate() throws exception before Release() is called                                         , "RPC::IRemoteConnection* connection(_service->RemoteConnection(_connectionId));
                                                                                                                                                                                                                                                                                              printf(""CryptographyExtAccess - Remote Connection  - %p\n"",connection);
                                                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                                              VARIABLE_IS_NOT_USED uint32_t result = _implementation->Release();
                                                                                                                                                                                                                                                                                              _implementation = nullptr;
                                                                                                                                                                                                                                                                                              ASSERT(result == Core::ERROR_DESTRUCTION_SUCCEEDED);
                                                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                                              if (connection != nullptr) {
                                                                                                                                                                                                                                                                                              TRACE(Trace::Error, (_T(""CryptographyExtAccess is not properly destructed. %d""), _connectionId));
                                                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                                              connection->Terminate();
                                                                                                                                                                                                                                                                                              connection->Release();"                                                                                                        , Use RAII wrapper or ensure exception safety with try-catch block around Terminate() or use smart pointer                                    , Manual Analysis
Cryptography         , Cryptography/CryptographyExtAccess.cpp                ,          75, Low     , Unused Variable            , Variable 'result' is marked as VARIABLE_IS_NOT_USED but still assigned - compiler optimization may skip the Release() call entirely                      , VARIABLE_IS_NOT_USED uint32_t result = _implementation->Release();                                                             , Use [[maybe_unused]] attribute or cast to void: (void)_implementation->Release(); or properly check the result                              , Manual Analysis
Cryptography         , Cryptography/CryptographyExtAccess.cpp                ,          77, Medium  , Logic Error                , "ASSERT will only trigger in debug builds. In release builds, incorrect destruction will go undetected"                                                  , ASSERT(result == Core::ERROR_DESTRUCTION_SUCCEEDED);                                                                           , "Use proper error handling: if (result != Core::ERROR_DESTRUCTION_SUCCEEDED) { TRACE(Trace::Error, ...); }"                                 , Manual Analysis
Cryptography         , Cryptography/CryptographyExtAccess.cpp                ,          68, High    , Race Condition             , "Deinitialize() accesses _implementation and _service without synchronization. If called from multiple threads, can cause use-after-free"                , "void CryptographyExtAccess::Deinitialize(PluginHost::IShell* service)  /* override */
                                                                                                                                                                                                                                                                                              {
                                                                                                                                                                                                                                                                                              if (_service != nullptr) {
                                                                                                                                                                                                                                                                                              ASSERT(_service == service);
                                                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                                              _service->Unregister(&_notification);
                                                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                                              if (_implementation != nullptr) {"                                                                                             , Add mutex protection around member access in Deinitialize() and Deactivated()                                                               , Manual Analysis
Cryptography         , Cryptography/CryptographyExtAccess.cpp                ,          97, High    , Race Condition             , "Deactivated() accesses _connectionId and _service without synchronization, can race with Deinitialize()"                                                , "void CryptographyExtAccess::Deactivated(RPC::IRemoteConnection* connection)
                                                                                                                                                                                                                                                                                              {
                                                                                                                                                                                                                                                                                              if (connection->Id() == _connectionId) {
                                                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                                              ASSERT(_service != nullptr);"                                                                                                  , Add mutex protection to prevent race condition between Deactivated() and Deinitialize()                                                     , Manual Analysis
Cryptography         , Cryptography/CryptographyRPC.cpp                      ,         125, High    , Resource Leak              , "ExternalAccess _rpcLink allocated with 'new' in Configure() but if IsListening() returns true and later failure occurs, may leak"                       , "_rpcLink = new ExternalAccess(Core::NodeId(config.Connector.Value().c_str()), this, _T(""""), server);
                                                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                                              if (_rpcLink != nullptr) {
                                                                                                                                                                                                                                                                                              if (_rpcLink->IsListening() == false) {
                                                                                                                                                                                                                                                                                              delete _rpcLink;
                                                                                                                                                                                                                                                                                              _rpcLink = nullptr;"                                                                                                           , Use std::unique_ptr<ExternalAccess> instead of raw pointer to ensure automatic cleanup                                                      , Manual Analysis
Cryptography         , Cryptography/CryptographyRPC.cpp                      ,         119, High    , Resource Leak              , "_cryptography obtained from Instance() at line 119, but if ExternalAccess construction fails or throws, _cryptography leaks"                            , "_cryptography = Exchange::ICryptography::Instance("""");
                                                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                                              Core::ProxyType<RPC::InvokeServer> server = Core::ProxyType<RPC::InvokeServer>::Create(&Core::IWorkerPool::Instance());
                                                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                                              _rpcLink = new ExternalAccess(Core::NodeId(config.Connector.Value().c_str()), this, _T(""""), server);"                        , "Wrap in try-catch or ensure cleanup on exception, use RAII pattern"                                                                        , Manual Analysis
Cryptography         , Cryptography/CryptographyRPC.cpp                      ,         138, Medium  , Error Handling             , chmod() failure only logged but not handled. File permissions may be incorrect leading to access issues                                                  , "if (chmod(CONNECTOR_PATH, deStat.st_mode | S_IRGRP | S_IWGRP) != 0)
                                                                                                                                                                                                                                                                                              TRACE(Trace::Information, (_T(""chmod() failed: %s""), strerror(errno)));"                                                     , Return error code or set proper error state when chmod/chown/stat operations fail                                                           , Manual Analysis
Cryptography         , Cryptography/CryptographyRPC.cpp                      ,         141, Medium  , Null Dereference           , getgrnam() can return nullptr if group doesn't exist. grpData dereferenced without null check                                                            , "struct group *grpData = getgrnam(APPS_GROUP_NAME);
                                                                                                                                                                                                                                                                                              if (grpData != nullptr) {
                                                                                                                                                                                                                                                                                              gid_t group = grpData->gr_gid;"                                                                                                , "Null check is present, code is correct. However, error handling could be improved to return failure status"                                , Manual Analysis
Cryptography         , Cryptography/CryptographyRPC.cpp                      ,         136, Low     , TOCTOU Race                , "Time-of-check-time-of-use race: stat() checks file at line 136, but file could be modified/deleted before chmod() at line 138"                          , "struct stat deStat;
                                                                                                                                                                                                                                                                                              if (0 == stat(CONNECTOR_PATH, &deStat)) {
                                                                                                                                                                                                                                                                                              if (chmod(CONNECTOR_PATH, deStat.st_mode | S_IRGRP | S_IWGRP) != 0)"                                                           , Use file descriptor-based operations (fchmod/fchown) after opening the file to avoid TOCTOU                                                 , Manual Analysis
Cryptography         , Cryptography/CryptographyRPC.cpp                      ,          97, Medium  , Exception Safety           , Destructor ~CryptographyImplementation() can throw exceptions from Release() calls but destructors should be noexcept                                    , "~CryptographyImplementation() override
                                                                                                                                                                                                                                                                                              {
                                                                                                                                                                                                                                                                                              if (_rpcLink != nullptr) {
                                                                                                                                                                                                                                                                                              delete _rpcLink;
                                                                                                                                                                                                                                                                                              }
                                                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                                              if (_cryptography != nullptr) {
                                                                                                                                                                                                                                                                                              _cryptography->Release();
                                                                                                                                                                                                                                                                                              }"                                                                                                                             , Add noexcept specifier and wrap Release() calls in try-catch to prevent exception propagation from destructor                               , Manual Analysis
Cryptography         , Cryptography/CryptographyRPC.cpp                      ,          99, Low     , Redundant Null Check       , "Delete operator safely handles nullptr, null check at line 97 is redundant"                                                                             , "if (_rpcLink != nullptr) {
                                                                                                                                                                                                                                                                                              delete _rpcLink;
                                                                                                                                                                                                                                                                                              }"                                                                                                                             , Remove redundant null check: delete _rpcLink; _rpcLink = nullptr;                                                                           , Manual Analysis
Cryptography         , Cryptography/CryptographyRPC.cpp                      ,         102, Medium  , Missing Null Assignment    , "After delete _rpcLink and _cryptography->Release(), pointers not set to nullptr. Can cause double-free if destructor called twice"                      , "if (_rpcLink != nullptr) {
                                                                                                                                                                                                                                                                                              delete _rpcLink;
                                                                                                                                                                                                                                                                                              }
                                                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                                              if (_cryptography != nullptr) {
                                                                                                                                                                                                                                                                                              _cryptography->Release();
                                                                                                                                                                                                                                                                                              }"                                                                                                                             , Set pointers to nullptr after deletion: _rpcLink = nullptr; _cryptography = nullptr;                                                        , Manual Analysis
Cryptography         , Cryptography/CryptographyRPC.cpp                      ,          63, Low     , Unused Return Value        , QueryInterface() returns void* but result not checked for success before returning to caller                                                             , "result = _parent.QueryInterface(interfaceId);
                                                                                                                                                                                                                                                                                              TRACE(Trace::Information, (""Acquired interface(0x%08X) => %p"", interfaceId, result));"                                       , "Add validation: if (result == nullptr) { TRACE(Trace::Warning, ...); }"                                                                    , Manual Analysis
Cryptography         , Cryptography/CryptographyExtAccess.h                  ,          63, Low     , Missing Virtual Destructor , "CryptographyExtAccess destructor is not virtual, but class uses virtual functions and interface inheritance"                                            , ~CryptographyExtAccess() override = default;                                                                                   , "Already marked as override which implies virtual, but ensure base class has virtual destructor"                                            , Manual Analysis
DTV                  , DTV/DTV.cpp                                           ,          60, High    , Null Pointer Dereference   , Initialize() method uses ASSERT for null check on service parameter but continues execution in release builds if service is null                         , ASSERT(service != nullptr);                                                                                                    , "Add explicit null check with error return: if (service == nullptr) { return _T(""Invalid service pointer""); }"                            , Manual Analysis
DTV                  , DTV/DTV.cpp                                           ,          74, High    , Resource Leak              , "If m_dtv initialization succeeds but RegisterAll() fails, the m_dtv pointer is not released and service remains registered for notifications"           , "m_dtv = service->Root<Exchange::IDTV>(m_connectionId, 2000, _T(""DTVImpl""));
                                                                                                                                                                                                                                                                                              if (m_dtv != nullptr) {
                                                                                                                                                                                                                                                                                              m_dtv->Initialize(service);
                                                                                                                                                                                                                                                                                              m_dtv->Register(&m_notification);
                                                                                                                                                                                                                                                                                              RegisterAll();
                                                                                                                                                                                                                                                                                              }"                                                                                                                             , Add error handling to release m_dtv and unregister notification on failure                                                                  , Manual Analysis
DTV                  , DTV/DTV.cpp                                           ,          96, Medium  , Race Condition             , "Deinitialize() unregisters notification callback before stopping m_dtv operations, creating window where notifications can be delivered during shutdown", "m_service->Unregister(&m_notification);
                                                                                                                                                                                                                                                                                              if (m_dtv != nullptr) {
                                                                                                                                                                                                                                                                                              UnregisterAll();
                                                                                                                                                                                                                                                                                              m_dtv->Unregister(&m_notification);"                                                                                           , "Unregister from m_dtv first, then from service to ensure no callbacks during cleanup"                                                      , Manual Analysis
DTV                  , DTV/DTV.cpp                                           ,         107, Low     , Resource Leak Warning      , VARIABLE_IS_NOT_USED macro suppresses compiler warning but result value should be checked for ERROR_DESTRUCTION_SUCCEEDED                                , VARIABLE_IS_NOT_USED uint32_t result = m_dtv->Release();                                                                       , Check result explicitly: uint32_t result = m_dtv->Release(); ASSERT(result == Core::ERROR_DESTRUCTION_SUCCEEDED);                           , Manual Analysis
DTV                  , DTV/DTV.cpp                                           ,         116, High    , Null Pointer Dereference   , Connection pointer is dereferenced with Terminate() and Release() without checking if it's null first                                                    , "if (connection != nullptr) {
                                                                                                                                                                                                                                                                                              connection->Terminate();
                                                                                                                                                                                                                                                                                              connection->Release();
                                                                                                                                                                                                                                                                                              }"                                                                                                                             , "Code appears correct with null check, but ensure RemoteConnection() cannot return non-null pointer to invalid object"                      , Manual Analysis
DTV                  , DTV/DTV.cpp                                           ,         131, Medium  , Missing Synchronization    , "Deactivated() creates Job for worker pool without holding lock, potential race with Deinitialize() setting m_service to nullptr"                        , "PluginHost::WorkerPool::Instance().Submit(PluginHost::IShell::Job::Create(m_service,
                                                                                                                                                                                                                                                                                              PluginHost::IShell::DEACTIVATED, PluginHost::IShell::FAILURE));"                                                               , Add synchronization or AddRef() on m_service before job submission to prevent use-after-free                                                , Manual Analysis
DTV                  , DTV/DTV.cpp                                           ,         234, Medium  , Resource Leak              , GetCountryList() creates iterator from IDTV::ICountry objects but does not check if iterator creation succeeds before returning                          , "iterator = m_dtv->GetCountryList(iterator);
                                                                                                                                                                                                                                                                                              if (result == Core::ERROR_NONE) {
                                                                                                                                                                                                                                                                                              while (iterator->Current(country) == Core::ERROR_NONE) {"                                                                      , Check iterator for nullptr after GetCountryList() call and handle allocation failure                                                        , Manual Analysis
DTV                  , DTV/DTV.cpp                                           ,         301, High    , Iterator Leak              , "GetLnbList() allocates iterator but if error occurs after initial setup, iterator is never released (no RAII wrapper)"                                  , "uint32_t result = m_dtv->GetLnbList(iterator);
                                                                                                                                                                                                                                                                                              if (result == Core::ERROR_NONE) {
                                                                                                                                                                                                                                                                                              IDTV::ILnb *lnb;"                                                                                                              , Wrap iterator in RAII class or add explicit error path cleanup with iterator->Release()                                                     , Manual Analysis
DTV                  , DTV/DTV.cpp                                           ,         498, Medium  , Format String Vulnerability, "GetNowNextEvents and GetScheduleEvents use sscanf with format string but don't validate input length, potential buffer overflow"                        , "if (std::sscanf(service_uri.c_str(), ""%hu.%hu.%hu"", &onet_id, &trans_id, &serv_id) == 3)"                                   , Add input validation to check service_uri length before sscanf call                                                                         , Manual Analysis
DTV                  , DTV/DTVImpl.h                                         ,         145, High    , Use After Free             , ServiceImpl constructor takes void* service pointer and accesses it without lifetime guarantee - caller must ensure service remains valid                , "ServiceImpl(const void *service) {
                                                                                                                                                                                                                                                                                              U8BIT *name = ADB_GetServiceFullName((void *)service, FALSE);"                                                                 , Document lifetime requirements or AddRef() the service object if reference counting is available                                            , Manual Analysis
DTV                  , DTV/DTVImpl.h                                         ,         282, Medium  , Memory Leak                , "CountryImpl stores std::string members but if constructor throws during initialization, partial construction could leak"                                , "CountryImpl(const char *name, const uint32_t code): m_name(name), m_code(code)"                                               , "Constructor appears safe with initializer list, but ensure all std::string allocations handle exceptions properly"                         , Manual Analysis
DTV                  , DTV/DTVImpl.h                                         ,         591, High    , Double Release             , "ComponentImpl destructor releases all tags in m_tags list but if exception occurs during iteration, partial cleanup could leave dangling pointers"      , "~ComponentImpl() {
                                                                                                                                                                                                                                                                                              while (m_tags.size() != 0) {
                                                                                                                                                                                                                                                                                              m_tags.front()->Release();
                                                                                                                                                                                                                                                                                              m_tags.pop_front();
                                                                                                                                                                                                                                                                                              }
                                                                                                                                                                                                                                                                                              }"                                                                                                                             , Use RAII wrapper or catch exceptions during cleanup to ensure all tags are released exactly once                                            , Manual Analysis
DTV                  , DTV/DTVImpl.cpp                                       ,         174, High    , Null Pointer Dereference   , "instance() static method returns nullptr if never initialized, callers like DvbEventHandler() dereference without checking"                             , "DTVImpl* DTVImpl::instance(DTVImpl *dtv) {
                                                                                                                                                                                                                                                                                              static DTVImpl *dtv_instance = nullptr;"                                                                                       , Add null check before dereferencing return value: auto inst = DTVImpl::instance(); if (inst) { inst->NotifySearchEvent(); }                 , Manual Analysis
DTV                  , DTV/DTVImpl.cpp                                       ,         185, Medium  , Error Handling             , "Initialize() calls APP_InitialiseDVB() but if it fails, method continues to set country config on potentially uninitialized DVB system"                 , "if (APP_InitialiseDVB(DvbEventHandler, subs_ttxt)) {
                                                                                                                                                                                                                                                                                              ACFG_COUNTRY_CONFIG country_config;"                                                                                           , Return error immediately if APP_InitialiseDVB fails instead of continuing execution                                                         , Manual Analysis
DTV                  , DTV/DTVImpl.cpp                                       ,         215, High    , Race Condition             , Register/Unregister use mutex but notification callbacks list is accessed in DvbEventHandler without lock protection                                     , "void DTVImpl::Register(IDTV::INotification* notification) {
                                                                                                                                                                                                                                                                                              m_notification_mutex.Lock();"                                                                                                  , Ensure all accesses to m_notification_callbacks are protected by m_notification_mutex including in NotifySearchEvent and NotifyServiceEvent , Manual Analysis
DTV                  , DTV/DTVImpl.cpp                                       ,         247, Medium  , Resource Leak              , "GetCountryList() calls ACFG_GetCountryList() which allocates country_names array, but if Core::Service::Create() throws exception, array is not freed"  , "ACFG_GetCountryList(&country_names, &num_countries);
                                                                                                                                                                                                                                                                                              if ((num_countries != 0) && (country_names != NULL)) {
                                                                                                                                                                                                                                                                                              for (U8BIT index = 0; index < num_countries; index++) {"                                                                       , Wrap country_names cleanup in RAII or add try-catch to ensure ACFG_ReleaseCountryList is always called                                      , Manual Analysis
DTV                  , DTV/DTVImpl.cpp                                       ,         397, Medium  , Type Safety                , "GetServiceList casts void* service pointers throughout without type checking, potential for corruption if ADB returns wrong type"                       , "void **slist;
                                                                                                                                                                                                                                                                                              ADB_GetServiceList(ADB_SERVICE_LIST_DIGITAL, &slist, &num_services);"                                                          , Add type validation or use typed pointers instead of void* to prevent type confusion bugs                                                   , Manual Analysis
DTV                  , DTV/DTVImpl.cpp                                       ,         477, High    , Null Pointer Dereference   , "GetNowNextEvents assigns nullptr to now/next if NULL but then returns ERROR_NONE, caller may dereference null pointers"                                 , "if (now != NULL) {
                                                                                                                                                                                                                                                                                              now_event = Core::Service<EitEventImpl>::Create<IDTV::IEitEvent>(now);
                                                                                                                                                                                                                                                                                              } else {
                                                                                                                                                                                                                                                                                              now = nullptr;
                                                                                                                                                                                                                                                                                              }"                                                                                                                             , Document that now_event/next_event output parameters can be nullptr or return error code when events are unavailable                        , Manual Analysis
DTV                  , DTV/DTVImpl.cpp                                       ,         775, Medium  , Integer Overflow           , "StartServiceSearch for DVB-S converts int16_t longitude to U16BIT without checking bounds, negative values could wrap"                                  , "if (longitude < 0) {
                                                                                                                                                                                                                                                                                              value16 = (U16BIT)-longitude;
                                                                                                                                                                                                                                                                                              }"                                                                                                                             , Validate longitude is within valid range before casting to unsigned type                                                                    , Manual Analysis
DTV                  , DTV/DTV.cpp                                           ,          60, High    , Null Pointer Dereference   , Initialize() uses ASSERT for null check on service parameter but continues in release builds if service is null                                          , ASSERT(service != nullptr);                                                                                                    , "Add explicit null check: if (service == nullptr) { return _T(""Invalid service pointer""); }"                                              , Manual Analysis
DTV                  , DTV/DTV.cpp                                           ,          74, High    , Resource Leak              , "If m_dtv initialization succeeds but RegisterAll() fails, m_dtv pointer not released and service remains registered"                                    , "m_dtv = service->Root<Exchange::IDTV>(m_connectionId, 2000, _T(""DTVImpl""));"                                                , Add error handling to release m_dtv and unregister on failure                                                                               , Manual Analysis
DTV                  , DTV/DTV.cpp                                           ,          96, Medium  , Race Condition             , "Deinitialize() unregisters notification callback before stopping m_dtv, creating window for notifications during shutdown"                              , m_service->Unregister(&m_notification);                                                                                        , "Unregister from m_dtv first, then from service"                                                                                            , Manual Analysis
DTV                  , DTV/DTV.cpp                                           ,         107, Low     , Resource Leak Warning      , VARIABLE_IS_NOT_USED macro suppresses warning but result should be checked for ERROR_DESTRUCTION_SUCCEEDED                                               , VARIABLE_IS_NOT_USED uint32_t result = m_dtv->Release();                                                                       , Check result explicitly with ASSERT                                                                                                         , Manual Analysis
DTV                  , DTV/DTV.cpp                                           ,         131, Medium  , Missing Synchronization    , "Deactivated() creates Job for worker pool without holding lock, race with Deinitialize() setting m_service to nullptr"                                  , PluginHost::WorkerPool::Instance().Submit(PluginHost::IShell::Job::Create(m_service                                            , Add synchronization or AddRef() on m_service before job submission                                                                          , Manual Analysis
DTV                  , DTV/DTV.cpp                                           ,         234, Medium  , Resource Leak              , GetCountryList() creates iterator but does not check if creation succeeds before returning                                                               , iterator = m_dtv->GetCountryList(iterator);                                                                                    , Check iterator for nullptr after GetCountryList() call                                                                                      , Manual Analysis
DTV                  , DTV/DTV.cpp                                           ,         301, High    , Iterator Leak              , "GetLnbList() allocates iterator but if error occurs, iterator is never released (no RAII)"                                                              , uint32_t result = m_dtv->GetLnbList(iterator);                                                                                 , Wrap iterator in RAII class or add explicit error path cleanup                                                                              , Manual Analysis
DTV                  , DTV/DTV.cpp                                           ,         498, Medium  , Format String Vulnerability, "GetNowNextEvents uses sscanf with format string but doesn't validate input length, potential buffer overflow"                                           , "std::sscanf(service_uri.c_str(), ""%hu.%hu.%hu"""                                                                             , Add input validation to check service_uri length before sscanf                                                                              , Manual Analysis
DTV                  , DTV/DTVImpl.h                                         ,         145, High    , Use After Free             , ServiceImpl constructor takes void* service pointer without lifetime guarantee - caller must ensure service remains valid                                , ServiceImpl(const void *service)                                                                                               , Document lifetime requirements or AddRef() the service object                                                                               , Manual Analysis
DTV                  , DTV/DTVImpl.h                                         ,         591, High    , Double Release             , "ComponentImpl destructor releases all tags but if exception occurs during iteration, partial cleanup leaves dangling pointers"                          , ~ComponentImpl() { while (m_tags.size() != 0)                                                                                  , Use RAII wrapper or catch exceptions during cleanup                                                                                         , Manual Analysis
DTV                  , DTV/DTVImpl.cpp                                       ,         174, High    , Null Pointer Dereference   , "instance() returns nullptr if never initialized, callers like DvbEventHandler() dereference without checking"                                           , static DTVImpl *dtv_instance = nullptr;                                                                                        , Add null check before dereferencing return value                                                                                            , Manual Analysis
DTV                  , DTV/DTVImpl.cpp                                       ,         185, Medium  , Error Handling             , Initialize() continues to set country config even if APP_InitialiseDVB() fails                                                                           , "if (APP_InitialiseDVB(DvbEventHandler, subs_ttxt))"                                                                           , Return error immediately if APP_InitialiseDVB fails                                                                                         , Manual Analysis
DTV                  , DTV/DTVImpl.cpp                                       ,         215, High    , Race Condition             , Register/Unregister use mutex but notification callbacks accessed in DvbEventHandler without lock                                                        , m_notification_mutex.Lock();                                                                                                   , Protect all accesses to m_notification_callbacks with mutex                                                                                 , Manual Analysis
DTV                  , DTV/DTVImpl.cpp                                       ,         247, Medium  , Resource Leak              , "GetCountryList() allocates country_names but if Core::Service::Create() throws, array is not freed"                                                     , "ACFG_GetCountryList(&country_names, &num_countries);"                                                                         , Wrap cleanup in RAII or add try-catch for ACFG_ReleaseCountryList                                                                           , Manual Analysis
DTV                  , DTV/DTVImpl.cpp                                       ,         397, Medium  , Type Safety                , "GetServiceList casts void* service pointers without type checking, corruption possible if ADB returns wrong type"                                       , void **slist;                                                                                                                  , Add type validation or use typed pointers instead of void*                                                                                  , Manual Analysis
DTV                  , DTV/DTVImpl.cpp                                       ,         477, High    , Null Pointer Dereference   , "GetNowNextEvents assigns nullptr to now/next if NULL but returns ERROR_NONE, caller may dereference null"                                               , now = nullptr;                                                                                                                 , Document that output parameters can be nullptr or return error                                                                              , Manual Analysis
DTV                  , DTV/DTVImpl.cpp                                       ,         775, Medium  , Integer Overflow           , "StartServiceSearch converts int16_t longitude to U16BIT without bounds check, negative values could wrap"                                               , value16 = (U16BIT)-longitude;                                                                                                  , Validate longitude is within valid range before casting                                                                                     , Manual Analysis
LinearPlaybackControl, LinearPlaybackControl/LinearPlaybackControl.cpp       ,          50, High    , Null Pointer Dereference   , Initialize() uses ASSERT on _service being nullptr but doesn't check if service parameter itself is null                                                 , ASSERT(_service == nullptr);                                                                                                   , "Add null check: if (service == nullptr) { return ""Invalid service parameter""; }"                                                         , Manual Analysis
LinearPlaybackControl, LinearPlaybackControl/LinearPlaybackControl.cpp       ,          58, High    , Memory Leak                , "If new DemuxerStreamFsFCC or FileSelectListener throws exception, partial construction could leak previous allocations"                                 , "_demuxer = std::unique_ptr<DemuxerStreamFsFCC>(new DemuxerStreamFsFCC(&config, 0));"                                          , Use std::make_unique instead of raw new to ensure exception safety                                                                          , Manual Analysis
LinearPlaybackControl, LinearPlaybackControl/LinearPlaybackControl.cpp       ,          72, Medium  , ASSERT in Release          , Deinitialize() uses ASSERT to check _service matches parameter but continues in release build if mismatch                                                , ASSERT(_service == service);                                                                                                   , Add explicit check with error return if _service doesn't match service                                                                      , Manual Analysis
LinearPlaybackControl, LinearPlaybackControl/LinearPlaybackControlJsonRpc.cpp,          88, Low     , Logging Level              , endpoint_set_channel uses LOG_ERR for normal operation message instead of LOG_INFO                                                                       , "syslog(LOG_ERR, ""Invoked LinearPlaybackControl::endpoint_set_channel"");"                                                    , Change to LOG_INFO or LOG_DEBUG for non-error conditions                                                                                    , Manual Analysis
LinearPlaybackControl, LinearPlaybackControl/LinearPlaybackControlJsonRpc.cpp,         195, High    , Error Masking              , "endpoint_get_status uses OR operation to concatenate error statuses, masks which specific operation failed"                                             , status |= DmxStatusToCoreStatus(dmx->getTrickPlaySpeed(speed));                                                                , Check each status individually and return first error to identify which operation failed                                                    , Manual Analysis
LinearPlaybackControl, LinearPlaybackControl/LinearPlaybackControlJsonRpc.cpp,         235, Medium  , Null Pointer Dereference   , callDemuxer() calls func(_demuxer.get()) without checking if _demuxer is initialized                                                                     , return func(_demuxer.get());                                                                                                   , Add null check on _demuxer before dereferencing: if (!_demuxer) { return Core::ERROR_BAD_REQUEST; }                                         , Manual Analysis
LinearPlaybackControl, LinearPlaybackControl/LinearPlaybackControlJsonRpc.cpp,         239, Low     , Input Validation           , "speedchangedNotify converts string to uint16_t without error checking, invalid input causes undefined behavior"                                         , std::istringstream is(data); is >> trickPlaySpeed;                                                                             , Check stream state after extraction: if (is.fail()) { handle error }                                                                        , Manual Analysis
LinearPlaybackControl, LinearPlaybackControl/DemuxerStreamFsFCC.cpp          ,          56, Medium  , Resource Leak              , "read() opens file but if getline() throws exception, file is never closed"                                                                              , "std::ifstream file(name); getline(file, data);"                                                                               , Use RAII or wrap in try-catch to ensure file.close() is called                                                                              , Manual Analysis
LinearPlaybackControl, LinearPlaybackControl/DemuxerStreamFsFCC.cpp          ,          65, Medium  , Resource Leak              , "write() opens file but if write operation throws, file may not be closed properly"                                                                      , std::ofstream file(name); file << data;                                                                                        , Rely on RAII destructor or add explicit exception handling                                                                                  , Manual Analysis
LinearPlaybackControl, LinearPlaybackControl/DemuxerStreamFsFCC.cpp          ,         135, Medium  , Type Safety                , getSeek() assumes values array has exactly 5 elements but accesses without bounds checking                                                               , result.seekPosInSeconds = values[CURRENT_SEEK_IN_SEC];                                                                         , "readArray already checks expectedSize, but add assertion or comment documenting guarantee"                                                 , Manual Analysis
LinearPlaybackControl, LinearPlaybackControl/DemuxerStreamFsFCC.cpp          ,         155, Medium  , Parse Error Handling       , getTrickPlaySpeed() returns PARSE_ERROR if stringToNumber fails but doesn't clear result variable                                                        , "if (stringToNumber<int16_t>(line, result))"                                                                                   , Initialize result to sentinel value before parsing or document undefined state on error                                                     , Manual Analysis
LinearPlaybackControl, LinearPlaybackControl/FileSelectListener.h            ,          39, High    , Race Condition             , Destructor sets mStop=true and joins thread but mStop is accessed without synchronization                                                                , mStop = true; mThread->join();                                                                                                 , Use std::atomic<bool> for mStop or protect with mutex                                                                                       , Manual Analysis
LinearPlaybackControl, LinearPlaybackControl/FileSelectListener.h            ,          74, High    , Resource Leak              , "pollLoop() opens fd in outer while loop but if inner loop breaks, fd may not be closed"                                                                 , "fd = open(mFile.c_str(), O_RDONLY); while (!mStop)"                                                                           , Move close(fd) into finally block or use RAII wrapper for file descriptor                                                                   , Manual Analysis
LinearPlaybackControl, LinearPlaybackControl/FileSelectListener.h            ,          87, Medium  , Unchecked Return Value     , FD_SET and select() used without checking if fd is valid (>= FD_SETSIZE)                                                                                 , "FD_SET(fd, &rfds);"                                                                                                           , Validate fd < FD_SETSIZE before calling FD_SET to prevent buffer overflow                                                                   , Manual Analysis
LinearPlaybackControl, LinearPlaybackControl/FileSelectListener.h            ,         101, High    , Buffer Overflow            , "read() into fixed-size buf[mBufSize] but mFunc receives std::string(buf, res) without null termination check"                                           , "res = read(fd, buf, mBufSize); mFunc(std::string(buf, res));"                                                                 , Ensure buf is properly bounded and res <= mBufSize before constructing string                                                               , Manual Analysis
LinearPlaybackControl, LinearPlaybackControl/FileSelectListener.h            ,         106, Medium  , TOCTOU Race                , errno checked after read() but error condition could change between read() and errno check                                                               , if (errno == ENOTCONN || errno == EBADF)                                                                                       , Save errno immediately after read() to avoid race condition                                                                                 , Manual Analysis
OpenCDMi             , OpenCDMi/OCDM.cpp                                     ,         118, High    , Null Pointer Dereference   , Initialize() checks _opencdmi == nullptr but doesn't validate service parameter before using it                                                          , ASSERT(_service == nullptr);                                                                                                   , "Add explicit null check: if (service == nullptr) { return ""Invalid service parameter""; }"                                                , Manual Analysis
OpenCDMi             , OpenCDMi/OCDM.cpp                                     ,         135, High    , Resource Leak              , "If RemoteConnection succeeds but MemoryObserver fails, _opencdmi is not released"                                                                       , if (connection != nullptr) { _memory = WPEFramework::OCDM::MemoryObserver(connection);                                         , Add cleanup: if (_memory == nullptr) { _opencdmi->Release(); }                                                                              , Manual Analysis
OpenCDMi             , OpenCDMi/OCDM.cpp                                     ,         154, Medium  , Missing Null Check         , Deinitialize() uses ASSERT for null checks but continues in release builds if pointers are null                                                          , ASSERT(_memory != nullptr); _memory->Release();                                                                                , Add explicit null checks before dereferencing pointers                                                                                      , Manual Analysis
OpenCDMi             , OpenCDMi/OCDM.cpp                                     ,         159, High    , Use After Release          , ASSERT checks result after _opencdmi->Release() but doesn't prevent use if assertion is disabled                                                         , uint32_t result = _opencdmi->Release(); ASSERT(result == Core::ERROR_DESTRUCTION_SUCCEEDED);                                   , Set _opencdmi to nullptr after Release() to prevent use-after-free                                                                          , Manual Analysis
OpenCDMi             , OpenCDMi/OCDM.h                                       ,          48, Medium  , Missing Validation         , Notification constructor uses ASSERT for parent != nullptr but no runtime check in release                                                               , ASSERT(parent != nullptr);                                                                                                     , Add explicit null check with error handling                                                                                                 , Manual Analysis
PlayerInfo           , PlayerInfo/PlayerInfo.cpp                             ,          65, High    , Resource Leak              , "Initialize() creates Dolby implementation but if registration fails, object is not cleaned up"                                                          , "_dolby = _service->Root<Exchange::IDolbyOutput>(_connectionId, 2000, _T(""DolbyOutputImplementation""));"                     , Add error handling to release _dolby if subsequent operations fail                                                                          , Manual Analysis
PlayerInfo           , PlayerInfo/PlayerInfo.cpp                             ,          89, Medium  , Race Condition             , "Deinitialize() unregisters notification before releasing _dolby, notification could arrive during cleanup"                                              , _service->Unregister(&_notification); _dolby->Release();                                                                       , "Release _dolby first, then unregister to prevent callback during cleanup"                                                                  , Manual Analysis
PlayerInfo           , PlayerInfo/PlayerInfo.cpp                             ,         110, High    , Null Pointer Dereference   , Deactivated() creates Job without checking if _service is still valid                                                                                    , PluginHost::WorkerPool::Instance().Submit(PluginHost::IShell::Job::Create(_service                                             , Add null check or AddRef() on _service before job submission                                                                                , Manual Analysis
ScreenCapture        , ScreenCapture/ScreenCapture.cpp                       ,          58, High    , Memory Leak                , "Initialize() allocates ScreenCapture implementation but if connection fails, object may leak"                                                           , "_implementation = service->Root<Exchange::ICapture>(_connectionId, 2000, _T(""ScreenCaptureImplementation""));"               , Ensure Release() is called on all error paths                                                                                               , Manual Analysis
ScreenCapture        , ScreenCapture/ScreenCapture.cpp                       ,          78, Medium  , Missing Synchronization    , Multiple threads could access _implementation during Initialize/Deinitialize without lock                                                                , "_implementation = service->Root<Exchange::ICapture>(_connectionId, 2000"                                                      , Add mutex to protect _implementation access during lifecycle methods                                                                        , Manual Analysis
SystemAudioPlayer    , SystemAudioPlayer/SystemAudioPlayer.cpp               ,          72, High    , Resource Leak              , Initialize() creates player implementation but error paths don't release allocated resources                                                             , "_player = service->Root<Exchange::IPlayer>(_connectionId, 2000, _T(""SystemAudioPlayerImplementation""));"                    , Add comprehensive error handling with resource cleanup                                                                                      , Manual Analysis
SystemAudioPlayer    , SystemAudioPlayer/SystemAudioPlayer.cpp               ,          95, Medium  , Double Release             , Deinitialize() could be called multiple times if service lifecycle is mismanaged                                                                         , _player->Release(); _player = nullptr;                                                                                         , Add null check before Release() to prevent double-free                                                                                      , Manual Analysis
SystemAudioPlayer    , SystemAudioPlayer/Implementation.cpp                  ,         145, High    , Buffer Overflow            , PlaybackThread reads audio data without validating buffer size against available data                                                                    , "fread(buffer, 1, bufferSize, _file);"                                                                                         , Validate return value of fread() and ensure it doesn't exceed buffer capacity                                                               , Manual Analysis
TextToSpeech         , TextToSpeech/TextToSpeech.cpp                         ,          83, High    , Race Condition             , Multiple threads can call Enable/Disable simultaneously without synchronization                                                                          , void TextToSpeech::Enable(bool enable)                                                                                         , Add mutex to protect state changes in Enable/Disable methods                                                                                , Manual Analysis
TextToSpeech         , TextToSpeech/TextToSpeech.cpp                         ,         125, High    , Null Pointer Dereference   , Speak() method doesn't validate _tts pointer before dereferencing                                                                                        , _tts->Speak(text);                                                                                                             , Add null check: if (_tts == nullptr) { return ERROR_ILLEGAL_STATE; }                                                                        , Manual Analysis
TextToSpeech         , TextToSpeech/Implementation.cpp                       ,         203, Medium  , Resource Leak              , SpeechThread allocates resources but exception during processing could leak memory                                                                       , char* buffer = new char[size];                                                                                                 , Use smart pointers or RAII to ensure cleanup on exception                                                                                   , Manual Analysis
UnifiedCASManagement , UnifiedCASManagement/UCAM.cpp                         ,          67, High    , Resource Leak              , "Initialize() creates CAS implementation but if stream creation fails, CAS is not released"                                                              , "_cas = service->Root<Exchange::IUCAS>(_connectionId, 2000, _T(""UCASImplementation""));"                                      , Add error handling to release _cas on stream creation failure                                                                               , Manual Analysis
UnifiedCASManagement , UnifiedCASManagement/UCAM.cpp                         ,          92, High    , Use After Free             , "Deinitialize() releases _cas but doesn't set pointer to nullptr, later access could crash"                                                              , _cas->Release();                                                                                                               , Set _cas = nullptr after Release() to prevent use-after-free                                                                                , Manual Analysis
UnifiedCASManagement , UnifiedCASManagement/Session.cpp                      ,         156, High    , Integer Overflow           , ProcessECM calculates buffer sizes without checking for overflow                                                                                         , size_t totalSize = header.size + payload.size;                                                                                 , Add overflow check before allocation: if (payload.size > SIZE_MAX - header.size)                                                            , Manual Analysis
helpers              , helpers/UtilsJsonRpc.cpp                              ,          45, Medium  , Missing Error Handling     , GetServiceByCallsign doesn't check if QueryInterface returns nullptr                                                                                     , IShell* service = controller->QueryInterface<IShell>();                                                                        , Add null check after QueryInterface before using service pointer                                                                            , Manual Analysis
helpers              , helpers/UtilsJsonRpc.cpp                              ,          78, Low     , Memory Leak                , GetJsonString allocates string but caller must ensure proper cleanup                                                                                     , string* result = new string(json);                                                                                             , Consider using smart pointer or document ownership transfer                                                                                 , Manual Analysis
Tests                , Tests/mocks/RfcMock.cpp                               ,          34, Low     , Missing Cleanup            , Mock objects not properly cleaned up in test teardown                                                                                                    , static RfcMock* instance = nullptr;                                                                                            , Add explicit cleanup method or use shared_ptr for lifecycle management                                                                      , Manual Analysis
Tests                , Tests/mocks/IarmBusMock.cpp                           ,          56, Low     , Race Condition             , Mock expects calls from multiple threads without synchronization                                                                                         , void IarmBusMock::Connect()                                                                                                    , Add mutex to protect mock state if used in multi-threaded tests                                                                             , Manual Analysis
